(DONE) TODO: The tests in some headers are the same. When have time refactor the code, with abstracting these tests somehow and somewhere...